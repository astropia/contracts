# 笔记

## Astropia

[Astropia.sol](./Astropia.sol)是管理游戏几乎所有资产（包括非同质化的角色、装备及同质化的游戏内货币、点数等）的[ERC1155](https://eips.ethereum.org/EIPS/eip-1155)智能合约，允许经过批准的（游戏逻辑）合约铸造新的NFT/FT。

### Token ID规则

为管理和区分不同Token，合约中使用`uint256`格式记录的Token Type ID加以区分。规定其值的最高位索引为1，最低位索引为256，对ID中各位信息的含义及铸币合约应该遵守的规范进行规定：

| 位置 | 长度 | 名称 | 规则 |
| - | - | - | - |
| 1 | 1 | NFT/FT标记 | 1表示当前Token为NFT，0为FT |
| 2-4 | 3 | 保留位 | 在无新规定之前均为0 |
| 5-112 | 108 | Token类别 | Token的名称/类别ID，铸币合约必须保证同一类FT/NFT的类别ID完全一致，不同FT/NFT必须有不同的类别ID |
| 113-128 | 16 | 铸币合约索引 | 铸币合约必须保证该字段均为0。对于NFT，Astropia会根据铸币合约的索引来填充该字段 |
| 129-256 | 128 | NFT ID | NFT的代币ID。对于FT该字段均为0，而NFT应当避免该字段全为0 |

根据规则，高112位为Token Type信息位，低144位为NFT信息位，并且强制包含了16位的铸币来源信息。

#### Example

`0x8000000000417374726f706961720001c8dbe2f0931e6e922d765e0aef396e8c`
该ID代表一个特定种类的唯一NFT：
* `0x8`为最高位的NFT标记
* `0x000000000417374726f70696172`为Token类别ID
* `0x0001`为铸币合约索引
* `0xc8dbe2f0931e6e922d765e0aef396e8c`为NFT内唯一ID

`0x0000000000417374726f70696172000000000000000000000000000000000000`
该ID代表一类特定种类的FT：
* `0x0`为最高位的FT标记
* `0x000000000417374726f70696172`为Token类别ID
* `0x000000000000000000000000000000000000`为FT强制为0字段

---

## CardPool #1

[CardPool_1_Origin.sol](./CardPool_1_Origin.sol)是第一期卡池的铸币合约，仅生产一种NFT：Asrtopiar——即游戏内的初始人物卡牌。
